<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' data:; img-src 'self' data: blob: https:; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; connect-src 'self' data:">
    <title>Vision Auto v2</title>
    <link rel="stylesheet" href="styles/base.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/layout.css">
</head>
<body>
    <div id="app">
        <!-- 사이드바 -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1 class="app-title">Vision Auto</h1>
                <span class="app-version">v2.0.0</span>
            </div>

            <nav class="sidebar-nav">
                <button class="nav-item active" data-view="dashboard">
                    <span class="nav-icon">H</span>
                    <span class="nav-label">대시보드</span>
                </button>
                <button class="nav-item" data-view="device">
                    <span class="nav-icon">D</span>
                    <span class="nav-label">디바이스</span>
                </button>
                <button class="nav-item" data-view="screen">
                    <span class="nav-icon">S</span>
                    <span class="nav-label">화면</span>
                </button>
                <button class="nav-item" data-view="actions">
                    <span class="nav-icon">A</span>
                    <span class="nav-label">액션</span>
                </button>
                <button class="nav-item" data-view="macros">
                    <span class="nav-icon">M</span>
                    <span class="nav-label">매크로</span>
                </button>
                <button class="nav-item" data-view="settings">
                    <span class="nav-icon">C</span>
                    <span class="nav-label">설정</span>
                </button>
            </nav>

            <div class="sidebar-footer">
                <button class="btn btn-ghost btn-sm" id="btn-logs">
                    로그
                </button>
                <button class="btn btn-ghost btn-sm" id="btn-help">
                    도움말
                </button>
            </div>
        </aside>

        <!-- 메인 콘텐츠 -->
        <main class="main-content">
            <!-- 대시보드 뷰 (통합) -->
            <section id="dashboard-view" class="view active">
                <header class="view-header">
                    <h2>통합 대시보드</h2>
                    <div class="header-actions">
                        <button class="btn btn-primary" id="btn-quick-macro">빠른 매크로 실행</button>
                    </div>
                </header>

                <div class="view-content dashboard-grid">
                    <!-- 디바이스 상태 카드 -->
                    <div class="dashboard-card">
                        <h3>디바이스 상태</h3>
                        <div class="card-content">
                            <div id="dashboard-device-status">
                                <div class="status-icon">📱</div>
                                <div class="status-text">연결 대기중</div>
                                <button class="btn btn-sm btn-primary" onclick="ui.switchView('device')">디바이스 연결</button>
                            </div>
                        </div>
                    </div>

                    <!-- 실시간 화면 미리보기 -->
                    <div class="dashboard-card screen-preview">
                        <h3>화면 미리보기</h3>
                        <div class="card-content">
                            <canvas id="dashboard-screen-canvas" width="360" height="640"></canvas>
                            <div class="preview-controls">
                                <button class="btn btn-sm" id="btn-dashboard-capture">캡처</button>
                                <button class="btn btn-sm btn-primary" id="btn-dashboard-stream">스트리밍</button>
                            </div>
                        </div>
                    </div>

                    <!-- 빠른 액션 -->
                    <div class="dashboard-card">
                        <h3>빠른 액션</h3>
                        <div class="card-content quick-actions">
                            <button class="quick-action" data-action="tap">탭</button>
                            <button class="quick-action" data-action="swipe">스와이프</button>
                            <button class="quick-action" data-action="back">뒤로</button>
                            <button class="quick-action" data-action="home">홈</button>
                            <button class="quick-action" data-action="recent">최근앱</button>
                        </div>
                    </div>

                    <!-- 최근 매크로 -->
                    <div class="dashboard-card">
                        <h3>최근 매크로</h3>
                        <div class="card-content">
                            <div id="dashboard-recent-macros" class="macro-list-mini">
                                <div class="empty-state-mini">저장된 매크로가 없습니다</div>
                            </div>
                            <button class="btn btn-sm btn-secondary mt-2" onclick="ui.switchView('macros')">매크로 관리</button>
                        </div>
                    </div>

                    <!-- 실시간 로그 -->
                    <div class="dashboard-card log-card">
                        <h3>실시간 로그</h3>
                        <div class="card-content">
                            <div id="dashboard-logs" class="log-viewer-mini">
                                <div class="log-entry">시스템 준비됨</div>
                            </div>
                        </div>
                    </div>

                    <!-- 성능 모니터 -->
                    <div class="dashboard-card">
                        <h3>성능 모니터</h3>
                        <div class="card-content">
                            <div class="performance-stats">
                                <div class="stat-item">
                                    <label>FPS</label>
                                    <span id="dashboard-fps">0</span>
                                </div>
                                <div class="stat-item">
                                    <label>지연시간</label>
                                    <span id="dashboard-latency">0ms</span>
                                </div>
                                <div class="stat-item">
                                    <label>CPU</label>
                                    <span id="dashboard-cpu">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 디바이스 뷰 -->
            <section id="device-view" class="view">
                <header class="view-header">
                    <h2>디바이스 연결</h2>
                    <div class="header-actions">
                        <button class="btn btn-secondary" id="btn-scan-devices">
                            디바이스 검색
                        </button>
                        <button class="btn btn-secondary" id="btn-wireless-setup">
                            무선 연결
                        </button>
                    </div>
                </header>

                <div class="view-content">
                    <div id="device-list" class="device-list">
                        <div class="empty-state">
                            <p>연결된 디바이스가 없습니다</p>
                            <p class="text-muted">USB 디버깅을 활성화하고 디바이스를 연결하세요</p>
                        </div>
                    </div>

                    <div id="device-info" class="device-info hidden">
                        <h3>디바이스 정보</h3>
                        <div class="info-grid">
                            <div class="info-item">
                                <label>모델</label>
                                <span id="device-model">-</span>
                            </div>
                            <div class="info-item">
                                <label>Android 버전</label>
                                <span id="device-version">-</span>
                            </div>
                            <div class="info-item">
                                <label>해상도</label>
                                <span id="device-resolution">-</span>
                            </div>
                            <div class="info-item">
                                <label>상태</label>
                                <span id="device-status" class="badge">연결됨</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 화면 뷰 -->
            <section id="screen-view" class="view">
                <header class="view-header">
                    <h2>화면 미러링</h2>
                    <div class="header-actions">
                        <button class="btn btn-primary" id="btn-start-stream">
                            스트리밍 시작
                        </button>
                        <button class="btn btn-secondary" id="btn-screenshot">
                            스크린샷
                        </button>
                        <button class="btn btn-secondary" id="btn-record">
                            녹화
                        </button>
                    </div>
                </header>

                <div class="view-content">
                    <div class="screen-container">
                        <div id="screen-viewer" class="screen-viewer">
                            <canvas id="screen-canvas"></canvas>
                            <div class="screen-overlay hidden" id="screen-overlay">
                                <div class="coordinates">
                                    <span>X: <span id="coord-x">0</span></span>
                                    <span>Y: <span id="coord-y">0</span></span>
                                </div>
                            </div>
                        </div>

                        <div class="screen-controls">
                            <div class="control-group">
                                <label>품질</label>
                                <select id="stream-quality" class="form-select">
                                    <option value="high">높음</option>
                                    <option value="medium">보통</option>
                                    <option value="low">낮음</option>
                                </select>
                            </div>
                            <div class="control-group">
                                <label>FPS</label>
                                <input type="range" id="stream-fps" min="1" max="60" value="30" class="form-range">
                                <span id="fps-value">30</span>
                            </div>
                            <div class="control-group">
                                <button class="btn btn-secondary" id="btn-rotate">
                                    화면 회전
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 액션 뷰 -->
            <section id="actions-view" class="view">
                <header class="view-header">
                    <h2>액션 빌더</h2>
                    <div class="header-actions">
                        <button class="btn btn-primary" id="btn-add-action">
                            액션 추가
                        </button>
                        <button class="btn btn-secondary" id="btn-test-action">
                            테스트
                        </button>
                    </div>
                </header>

                <div class="view-content">
                    <div class="action-builder">
                        <div class="action-types">
                            <button class="action-type-btn" data-type="tap">
                                <span class="action-icon">T</span>
                                <span>탭</span>
                            </button>
                            <button class="action-type-btn" data-type="swipe">
                                <span class="action-icon">S</span>
                                <span>스와이프</span>
                            </button>
                            <button class="action-type-btn" data-type="input">
                                <span class="action-icon">I</span>
                                <span>입력</span>
                            </button>
                            <button class="action-type-btn" data-type="wait">
                                <span class="action-icon">W</span>
                                <span>대기</span>
                            </button>
                            <button class="action-type-btn" data-type="key">
                                <span class="action-icon">K</span>
                                <span>키</span>
                            </button>
                        </div>

                        <div id="action-params" class="action-params hidden">
                            <!-- 동적으로 생성됨 -->
                        </div>

                        <div id="action-list" class="action-list">
                            <h3>현재 액션</h3>
                            <div class="action-items">
                                <!-- 액션 목록 -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 매크로 뷰 -->
            <section id="macros-view" class="view">
                <header class="view-header">
                    <h2>매크로 관리</h2>
                    <div class="header-actions">
                        <button class="btn btn-primary" id="btn-new-macro">
                            새 매크로
                        </button>
                        <button class="btn btn-secondary" id="btn-import-macro">
                            가져오기
                        </button>
                        <button class="btn btn-danger" id="btn-record-macro">
                            녹화
                        </button>
                    </div>
                </header>

                <div class="view-content">
                    <div class="macro-container">
                        <div class="macro-list">
                            <div class="search-bar">
                                <input type="text" id="macro-search" class="form-input" placeholder="매크로 검색...">
                            </div>
                            <div id="macro-items" class="macro-items">
                                <!-- 매크로 목록 -->
                            </div>
                        </div>

                        <div class="macro-editor hidden" id="macro-editor">
                            <div class="editor-header">
                                <input type="text" id="macro-name" class="form-input" placeholder="매크로 이름">
                                <div class="editor-actions">
                                    <button class="btn btn-success" id="btn-save-macro">저장</button>
                                    <button class="btn btn-primary" id="btn-run-macro">실행</button>
                                    <button class="btn btn-secondary" id="btn-export-macro">내보내기</button>
                                </div>
                            </div>
                            <textarea id="macro-description" class="form-textarea" placeholder="설명"></textarea>
                            <div id="macro-actions" class="macro-actions">
                                <!-- 매크로 액션 목록 -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 설정 뷰 -->
            <section id="settings-view" class="view">
                <header class="view-header">
                    <h2>설정</h2>
                    <div class="header-actions">
                        <button class="btn btn-secondary" id="btn-export-settings">
                            설정 내보내기
                        </button>
                        <button class="btn btn-danger" id="btn-reset-settings">
                            초기화
                        </button>
                    </div>
                </header>

                <div class="view-content">
                    <div class="settings-container">
                        <div class="settings-tabs">
                            <button class="tab-btn active" data-tab="general">일반</button>
                            <button class="tab-btn" data-tab="device">디바이스</button>
                            <button class="tab-btn" data-tab="screen">화면</button>
                            <button class="tab-btn" data-tab="macro">매크로</button>
                            <button class="tab-btn" data-tab="advanced">고급</button>
                        </div>

                        <div class="settings-content">
                            <!-- 동적으로 생성됨 -->
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- 상태바 -->
        <footer class="status-bar">
            <div class="status-left">
                <span id="connection-status" class="status-item">
                    <span class="status-indicator disconnected"></span>
                    <span>연결 안됨</span>
                </span>
            </div>
            <div class="status-right">
                <span id="macro-status" class="status-item">준비</span>
                <span id="fps-status" class="status-item">FPS: 0</span>
            </div>
        </footer>
    </div>

    <!-- 모달 컨테이너 -->
    <div id="modal-container"></div>

    <!-- 토스트 컨테이너 -->
    <div id="toast-container" class="toast-container"></div>

    <!-- 모달 대화상자들 -->
    <!-- 매크로 생성 모달 -->
    <div id="macro-name-modal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>새 매크로 만들기</h3>
                <button class="modal-close" onclick="ui.closeModal('macro-name-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>매크로 이름</label>
                    <input type="text" id="macro-name-input" class="form-control" placeholder="예: 자동 로그인">
                </div>
                <div class="form-group">
                    <label>설명 (선택사항)</label>
                    <textarea id="macro-description-input" class="form-control" rows="3" placeholder="이 매크로가 하는 일을 설명해주세요"></textarea>
                </div>
                <div class="info-box">
                    <strong>💡 매크로란?</strong>
                    <p>여러 액션(탭, 스와이프, 입력 등)을 순서대로 저장하여 한 번에 실행할 수 있는 자동화 스크립트입니다.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="ui.closeModal('macro-name-modal')">취소</button>
                <button class="btn btn-primary" onclick="ui.confirmCreateMacro()">만들기</button>
            </div>
        </div>
    </div>

    <script src="renderer.js"></script>
</body>
</html>